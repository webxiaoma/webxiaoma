---
sidebarDepth: 1
meta:
  - name: keywords
    content: webpack, webpack处理图像, url-loader，图片处理，压缩图片，image-webpack-loader，file-loader
  - name: description
    content: 本文主要讲述webpack中使用url-loader处理资源路径问题，使用image-webpack-loader处理图片的压缩问题。
---


# 懒加载

[GitHub 仓库练习](https://github.com/webxiaoma/webpack-demos/tree/master/webpack4/懒加载)

---

[webpack中的懒加载](https://webpack.docschina.org/guides/lazy-loading/)也称为按需加载，它是一种很好的优化网页或应用的方式。我们在做单页面应用时，因为只有一个`HTML`，我们许多功能的js或css等都会引入到其中，导致我们网页的首屏加载速度回变的很慢，这时候我们可以使用懒加载来解决这个问题，我们开始时只加载用户需要的功能，其他功能后续在去加载。


## 实现懒加载

比如现在我们目录结构是这样的

```
|--- node_modules
|--- src
   |--- alert.js
   |--- index.js
|--- .babelrc.
|--- index.html
|--- package.json
|--- webpack.config.js
```

我们在`alert.js`中写入
```js
module.exports = ()=>{
    alert("我是后加载的alert.js文件中的内容")
}
```

在`index.js`中写入

```JS
let btn = document.querySelector('button')

btn.onclick = ()=>{
    // 当点击按钮时加载 alert.js
    import(/*webpackChunkName: "alert"*/ './alert').then(module=>{
         module.default()
    })
}
```
该文件中当`webpack`遇到`import()`时会以`./alert`为入口生成一个`chunk`，并且当代码执行到`import()`后才会加载由`Chunk`对应生成的文件。  `/*webpackChunkName: "alert"*/` 这个注释的意思是为动态生成的`Chunk` 起一个名字, 这里需要结合`chunkFilenmae` 来输出文件名
```js
output: {
    filename: 'build.js',
    chunkFilename:'[name].[hash:5].js',
},
```

在`index.html`页面中我们代码如下
```html
 <!--body部分-->
<h1>懒加载</h1>
    
<button>点击加载 alert.js</button>
<!-- 引入打包后的js -->
```

另外我们使用动态的`import`语句需要安装[babel插件 babel-plugin-syntax-dynamic-import](https://www.npmjs.com/package/babel-plugin-syntax-dynamic-import),并在`.babelrc.`中配置

```js
{
  "plugins": ["syntax-dynamic-import"]
}
```

当我们运行后，页面并没有加载`alert.js`, 我们点击按钮button 时，`alert.js` 才会被加载，并执行相应的代码。



## 框架中实现懒加载

- [Vue 中使用懒加载](https://reacttraining.com/react-router/web/guides/code-splitting)

- [React 中使用懒加载](http://www.css88.com/doc/webpack2/guides/lazy-load-react/)