---
sidebarDepth: 1
meta:
  - name: keywords
    content: webpack, 单页面应用，自动构建html
  - name: description
    content: 本文主要讲述webpack中使用url-loader处理资源路径问题，使用image-webpack-loader处理图片的压缩问题。
---

# 处理目录文件

[GitHub 仓库练习](https://github.com/webxiaoma/webpack-demos/tree/master/webpack4/%E5%A4%84%E7%90%86%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6)

---

## 单页面自动构建HTML

我们使用webpack打包页面时并没有输出html文件，我们需要手动去新建一个html并引入js，这样操作对我们来说也很不方便，这里我们可以使用[html-webpack-plugin](https://github.com/jantimon/html-webpack-plugin)

### `html-webpack-plugin`插件
```js
npm i -D html-webpack-plugin
```

使用该插件

```js
const HtmlWebpackPlugin = require('html-webpack-plugin');

plugins: [
    new HtmlWebpackPlugin({
        title: '新html文件标题'
    })
]
```
### `html-webpack-template`插件

这里只是简单的生成`html`文件，另外我们还可以使用 [html-webpack-template](https://github.com/jaketrent/html-webpack-template)结合[html-webpack-plugin](https://github.com/jantimon/html-webpack-plugin)来定制我们想要生成的html。

例如我们想将我们以我们根目录下的`index.html`为模板,在此基础上生成新的`html`

```js
// 安装
npm i -D html-webpack-template
```

我们来配置一下

```js
plugins: [
    new HtmlWebpackPlugin({
         //使用自带模板时，设置为false,使用自己的html模板是设置为true
        inject: false, 
        // 模板路径'node_modules/html-webpack-template/index.ejs'
        template: require('html-webpack-template'),
        // template: './index.html', 
        //使用自己的模板时以下配置不起作用
        title: '模版html',
        links: [ // 引入<link>
            {
                href: 'http://webxiaoma.com/img/manong.jpg',
                rel: 'icon'
            }
        ],
        scripts: [ // 引入<script>
            'http://example.com/somescript.js'
        ]
    })
]
```

::: tip 提醒 
`html-webpack-template` 给我们提共了一个模板位于`node_modules/html-webpack-template/index.ejs`,如果我们使用它，则要将`inject`设置为`false`，因为当设置为`true`时，会在生成的html中注入两次我们的静态文件引入路径，（个人认为这是个`Bug`，测试时其版本为 <Badge>html-webpack-template 6.2.0</Badge>）。

当我们使用自己的html模板时，要将`inject`设置为`true`，这样才会将我们生成的静态文件引入到`html`中, 此时一些其他设置将无效，例如`title`，`links`,`scripts` 等等。

:::

### 类似其他插件

- [web-webpack-plugin 插件](https://github.com/gwuhaolin/web-webpack-plugin)



## 清除打包遗留文件

我们每次打包后可能会有上次遗留的文件，这样打包出来的项目会很乱，想要每次构建前清理 `/dist`文件夹我们可以使用[clean-webpack-plugin 插件](https://github.com/johnagan/clean-webpack-plugin)

```js
// 安装
npm i -D clean-webpack-plugin
```

然后我们来配置一下：

```js
const CleanWebpackPlugin = require('clean-webpack-plugin');

plugins: [
  new CleanWebpackPlugin(['dist'])
]
```

## 复制文件夹到打包目录

有时候我们想直接复制一个文件目录到打包出来的目录，而且该目录下的资源不希望被`webpack`编译，我们可以使用[copy-webpack-plugin 插件](https://github.com/webpack-contrib/copy-webpack-plugin)

```js
// 安装
npm i -D copy-webpack-plugin
```

简单配置如下：

```js
const CopyWebpackPlugin = require('copy-webpack-plugin');


plugins: [
  new CopyWebpackPlugin([
    {
      // 要复制的目录
      from: path.resolve(__dirname, './static'),
      // 打包到输出目录下的static目录中
      to: 'static',
      // 忽略png文件，['.*']表示复制任何文件
      ignore: ['*.png']
    }
  ])
]
```