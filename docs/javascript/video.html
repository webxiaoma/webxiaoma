<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>H5视频处理 | 马新想个人网站（webxiaoma）</title>
    <meta name="description" content="本文章主要总结在H5中处理视频video。">
    <link rel="icon" href="/img/icon.ico">
    <meta name="keywords" content="H5视频处理 video h5 video js视频">
    <link rel="preload" href="/assets/css/0.styles.97566d20.css" as="style"><link rel="preload" href="/assets/js/app.b5bf64aa.js" as="script"><link rel="preload" href="/assets/js/56.d2246bfc.js" as="script"><link rel="prefetch" href="/assets/js/10.a43becf7.js"><link rel="prefetch" href="/assets/js/100.79790541.js"><link rel="prefetch" href="/assets/js/101.ba402091.js"><link rel="prefetch" href="/assets/js/102.7f37dd35.js"><link rel="prefetch" href="/assets/js/103.0b589f8a.js"><link rel="prefetch" href="/assets/js/104.36d4a297.js"><link rel="prefetch" href="/assets/js/105.01ddbf3f.js"><link rel="prefetch" href="/assets/js/106.15d08253.js"><link rel="prefetch" href="/assets/js/107.ed9bffe7.js"><link rel="prefetch" href="/assets/js/108.2aedfbfa.js"><link rel="prefetch" href="/assets/js/109.36b63c81.js"><link rel="prefetch" href="/assets/js/11.dd3bc02b.js"><link rel="prefetch" href="/assets/js/110.7867e882.js"><link rel="prefetch" href="/assets/js/111.99dc1a91.js"><link rel="prefetch" href="/assets/js/112.3e2abe50.js"><link rel="prefetch" href="/assets/js/113.5ed0daee.js"><link rel="prefetch" href="/assets/js/114.5c430289.js"><link rel="prefetch" href="/assets/js/115.a09d91b3.js"><link rel="prefetch" href="/assets/js/116.760bf6ac.js"><link rel="prefetch" href="/assets/js/117.c162fa1d.js"><link rel="prefetch" href="/assets/js/118.3832af96.js"><link rel="prefetch" href="/assets/js/12.6626c043.js"><link rel="prefetch" href="/assets/js/13.2e7e151a.js"><link rel="prefetch" href="/assets/js/14.8ebc7a8b.js"><link rel="prefetch" href="/assets/js/15.3de2318d.js"><link rel="prefetch" href="/assets/js/16.da762ddc.js"><link rel="prefetch" href="/assets/js/17.5f4e64b0.js"><link rel="prefetch" href="/assets/js/18.41ee63c7.js"><link rel="prefetch" href="/assets/js/19.953c7613.js"><link rel="prefetch" href="/assets/js/2.ad99329b.js"><link rel="prefetch" href="/assets/js/20.0c814b68.js"><link rel="prefetch" href="/assets/js/21.7e558d1f.js"><link rel="prefetch" href="/assets/js/22.df62add3.js"><link rel="prefetch" href="/assets/js/23.3269893b.js"><link rel="prefetch" href="/assets/js/24.d0b7ac11.js"><link rel="prefetch" href="/assets/js/25.ea6099b3.js"><link rel="prefetch" href="/assets/js/26.ac17a213.js"><link rel="prefetch" href="/assets/js/27.2e943546.js"><link rel="prefetch" href="/assets/js/28.be76bfa4.js"><link rel="prefetch" href="/assets/js/29.6dcf3fa1.js"><link rel="prefetch" href="/assets/js/3.4e7942c3.js"><link rel="prefetch" href="/assets/js/30.aa229fb1.js"><link rel="prefetch" href="/assets/js/31.d3eda695.js"><link rel="prefetch" href="/assets/js/32.757d8f72.js"><link rel="prefetch" href="/assets/js/33.dba8491e.js"><link rel="prefetch" href="/assets/js/34.6c0d0a74.js"><link rel="prefetch" href="/assets/js/35.2223dd93.js"><link rel="prefetch" href="/assets/js/36.2b0f7b44.js"><link rel="prefetch" href="/assets/js/37.f57e4cdd.js"><link rel="prefetch" href="/assets/js/38.746d20b3.js"><link rel="prefetch" href="/assets/js/39.8eb99886.js"><link rel="prefetch" href="/assets/js/4.f6ae4cfc.js"><link rel="prefetch" href="/assets/js/40.4897882e.js"><link rel="prefetch" href="/assets/js/41.2ee37165.js"><link rel="prefetch" href="/assets/js/42.81f23906.js"><link rel="prefetch" href="/assets/js/43.9f997de2.js"><link rel="prefetch" href="/assets/js/44.6fceee93.js"><link rel="prefetch" href="/assets/js/45.4d746b25.js"><link rel="prefetch" href="/assets/js/46.4ef520a1.js"><link rel="prefetch" href="/assets/js/47.1be4b762.js"><link rel="prefetch" href="/assets/js/48.2f9e0c4d.js"><link rel="prefetch" href="/assets/js/49.2d917d0d.js"><link rel="prefetch" href="/assets/js/5.9d0b63f3.js"><link rel="prefetch" href="/assets/js/50.81c9e321.js"><link rel="prefetch" href="/assets/js/51.a34c1bc0.js"><link rel="prefetch" href="/assets/js/52.256c21f3.js"><link rel="prefetch" href="/assets/js/53.2b559954.js"><link rel="prefetch" href="/assets/js/54.5f0a7878.js"><link rel="prefetch" href="/assets/js/55.d4e44aa7.js"><link rel="prefetch" href="/assets/js/57.4692aa4f.js"><link rel="prefetch" href="/assets/js/58.1e0e42bc.js"><link rel="prefetch" href="/assets/js/59.709d9e20.js"><link rel="prefetch" href="/assets/js/6.ad473cbf.js"><link rel="prefetch" href="/assets/js/60.aec59b1e.js"><link rel="prefetch" href="/assets/js/61.d8e8fd82.js"><link rel="prefetch" href="/assets/js/62.21cbbea1.js"><link rel="prefetch" href="/assets/js/63.3fe98e61.js"><link rel="prefetch" href="/assets/js/64.e84698a3.js"><link rel="prefetch" href="/assets/js/65.0ec1cb00.js"><link rel="prefetch" href="/assets/js/66.bd26bd1f.js"><link rel="prefetch" href="/assets/js/67.fe7a883d.js"><link rel="prefetch" href="/assets/js/68.15b3afdc.js"><link rel="prefetch" href="/assets/js/69.5b19cfc0.js"><link rel="prefetch" href="/assets/js/7.17adf896.js"><link rel="prefetch" href="/assets/js/70.325600ba.js"><link rel="prefetch" href="/assets/js/71.ce699b17.js"><link rel="prefetch" href="/assets/js/72.920f860c.js"><link rel="prefetch" href="/assets/js/73.136b80a7.js"><link rel="prefetch" href="/assets/js/74.03fa0c74.js"><link rel="prefetch" href="/assets/js/75.2bcfd749.js"><link rel="prefetch" href="/assets/js/76.4019ddf1.js"><link rel="prefetch" href="/assets/js/77.4a1d2e0c.js"><link rel="prefetch" href="/assets/js/78.eb1ccde9.js"><link rel="prefetch" href="/assets/js/79.bc0b47e3.js"><link rel="prefetch" href="/assets/js/8.44914b79.js"><link rel="prefetch" href="/assets/js/80.7769467a.js"><link rel="prefetch" href="/assets/js/81.4701db5b.js"><link rel="prefetch" href="/assets/js/82.571ab4e7.js"><link rel="prefetch" href="/assets/js/83.350f1c93.js"><link rel="prefetch" href="/assets/js/84.721b9cc7.js"><link rel="prefetch" href="/assets/js/85.6c3f1089.js"><link rel="prefetch" href="/assets/js/86.20bedcd1.js"><link rel="prefetch" href="/assets/js/87.2ad8134f.js"><link rel="prefetch" href="/assets/js/88.39fca244.js"><link rel="prefetch" href="/assets/js/89.d1eb119c.js"><link rel="prefetch" href="/assets/js/9.d127dfc2.js"><link rel="prefetch" href="/assets/js/90.82aabff6.js"><link rel="prefetch" href="/assets/js/91.ac048abf.js"><link rel="prefetch" href="/assets/js/92.41b58ef6.js"><link rel="prefetch" href="/assets/js/93.91b0bf78.js"><link rel="prefetch" href="/assets/js/94.acee6d9b.js"><link rel="prefetch" href="/assets/js/95.c7db73df.js"><link rel="prefetch" href="/assets/js/96.0d3efce6.js"><link rel="prefetch" href="/assets/js/97.a4282f32.js"><link rel="prefetch" href="/assets/js/98.44e15af2.js"><link rel="prefetch" href="/assets/js/99.ae36764d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.97566d20.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/manong.jpg" alt="马新想" class="logo"> <span class="site-name can-hide">马新想个人网站</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide" data-v-e7df0cd8><ul role="menubar" class="el-menu-demo el-menu--horizontal el-menu" style="background-color:;" data-v-e7df0cd8><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;" data-v-e7df0cd8>
        首页
        <!----></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
        前端
      <i class="el-submenu__icon-arrow el-icon-arrow-down"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        JavaScript
         <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        ECMAScript6
         <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        设计模式
         <!----></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
          移动端
        <i class="el-submenu__icon-arrow el-icon-arrow-right"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           H5页面开发
           <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           PWA应用
           <!----></li></ul></div></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
          前端工具
        <i class="el-submenu__icon-arrow el-icon-arrow-right"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           Webpack打包
           <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           Git版本工具
           <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           ESLint代码检测
           <!----></li></ul></div></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        Vue
         <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        React
         <!----></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
          前端插件
        <i class="el-submenu__icon-arrow el-icon-arrow-right"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           日历插件
           <!----></li></ul></div></li></ul></div></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
        后端
      <i class="el-submenu__icon-arrow el-icon-arrow-down"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        Linux
         <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        NodeJS
         <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        
         <a href="https://webxiaoma.github.io/java-demos/docs/blogs/" target="_blank" style="display:block;line-height:35px;" data-v-e7df0cd8>Java</a></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
          数据库
        <i class="el-submenu__icon-arrow el-icon-arrow-right"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           MongoDB
           <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           
           <a href="https://webxiaoma.github.io/tools-docs/docs/blogs/database/mysql-install.html" target="_blank" style="display:block;line-height:35px;" data-v-e7df0cd8>MySQL</a></li></ul></div></li></ul></div></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;" data-v-e7df0cd8>
        知识点
        <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;" data-v-e7df0cd8>
        
        <a href="https://webxiaoma.github.io/tools-docs/docs/blogs/index.html" target="_blank" style="display:block;line-height:35px;" data-v-e7df0cd8>工具</a></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;" data-v-e7df0cd8>
        
        <a href="https://webwangjia.github.io/wechat-demo/docs/blogs/" target="_blank" style="display:block;line-height:35px;" data-v-e7df0cd8>微信</a></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;" data-v-e7df0cd8>
        
        <a href="https://github.com/webxiaoma" target="_blank" style="display:block;line-height:35px;" data-v-e7df0cd8>GitHub</a></li></ul></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar" data-v-6135aa50><nav class="nav-links" data-v-e7df0cd8 data-v-6135aa50><ul role="menubar" class="el-menu-demo el-menu--horizontal el-menu" style="background-color:;" data-v-e7df0cd8><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;" data-v-e7df0cd8>
        首页
        <!----></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
        前端
      <i class="el-submenu__icon-arrow el-icon-arrow-down"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        JavaScript
         <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        ECMAScript6
         <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        设计模式
         <!----></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
          移动端
        <i class="el-submenu__icon-arrow el-icon-arrow-right"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           H5页面开发
           <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           PWA应用
           <!----></li></ul></div></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
          前端工具
        <i class="el-submenu__icon-arrow el-icon-arrow-right"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           Webpack打包
           <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           Git版本工具
           <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           ESLint代码检测
           <!----></li></ul></div></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        Vue
         <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        React
         <!----></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
          前端插件
        <i class="el-submenu__icon-arrow el-icon-arrow-right"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           日历插件
           <!----></li></ul></div></li></ul></div></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
        后端
      <i class="el-submenu__icon-arrow el-icon-arrow-down"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        Linux
         <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        NodeJS
         <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
        
         <a href="https://webxiaoma.github.io/java-demos/docs/blogs/" target="_blank" style="display:block;line-height:35px;" data-v-e7df0cd8>Java</a></li><li role="menuitem" aria-haspopup="true" class="el-submenu" data-v-e7df0cd8><div class="el-submenu__title" style="border-bottom-color:transparent;color:;background-color:;">
          数据库
        <i class="el-submenu__icon-arrow el-icon-arrow-right"></i></div><div class="el-menu--horizontal" style="display:none;"><ul role="menu" class="el-menu el-menu--popup el-menu--popup-" style="background-color:;"> <li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           MongoDB
           <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;background-color:;" data-v-e7df0cd8>
           
           <a href="https://webxiaoma.github.io/tools-docs/docs/blogs/database/mysql-install.html" target="_blank" style="display:block;line-height:35px;" data-v-e7df0cd8>MySQL</a></li></ul></div></li></ul></div></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;" data-v-e7df0cd8>
        知识点
        <!----></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;" data-v-e7df0cd8>
        
        <a href="https://webxiaoma.github.io/tools-docs/docs/blogs/index.html" target="_blank" style="display:block;line-height:35px;" data-v-e7df0cd8>工具</a></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;" data-v-e7df0cd8>
        
        <a href="https://webwangjia.github.io/wechat-demo/docs/blogs/" target="_blank" style="display:block;line-height:35px;" data-v-e7df0cd8>微信</a></li><li role="menuitem" tabindex="-1" class="el-menu-item" style="color:;border-bottom-color:transparent;background-color:;" data-v-e7df0cd8>
        
        <a href="https://github.com/webxiaoma" target="_blank" style="display:block;line-height:35px;" data-v-e7df0cd8>GitHub</a></li></ul></nav>  <ul class="sidebar-links" data-v-6135aa50><li data-v-6135aa50><a href="/javascript/" class="sidebar-link" data-v-6135aa50>网站</a></li><li data-v-6135aa50><div class="sidebar-group collapsable" data-v-6135aa50><p class="sidebar-heading"><span>JS基础知识</span> <span class="arrow right"></span></p> <!----></div></li><li data-v-6135aa50><div class="sidebar-group collapsable" data-v-6135aa50><p class="sidebar-heading"><span>ES6篇</span> <span class="arrow right"></span></p> <!----></div></li><li data-v-6135aa50><div class="sidebar-group collapsable" data-v-6135aa50><p class="sidebar-heading open"><span>音频视频处理</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/javascript/audio.html" class="sidebar-link">H5音频处理</a></li><li><a href="/javascript/video.html" class="active sidebar-link">H5视频处理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javascript/video.html#video-标签" class="sidebar-link">Video 标签</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javascript/video.html#使用该标签" class="sidebar-link">使用该标签</a></li><li class="sidebar-sub-header"><a href="/javascript/video.html#video标签内属性" class="sidebar-link">video标签内属性</a></li><li class="sidebar-sub-header"><a href="/javascript/video.html#video对象属性-部分" class="sidebar-link">video对象属性(部分)</a></li><li class="sidebar-sub-header"><a href="/javascript/video.html#video-对像方法" class="sidebar-link">video 对像方法</a></li><li class="sidebar-sub-header"><a href="/javascript/video.html#多媒体事件" class="sidebar-link">多媒体事件</a></li><li class="sidebar-sub-header"><a href="/javascript/video.html#实例练习" class="sidebar-link">实例练习</a></li></ul></li><li class="sidebar-sub-header"><a href="/javascript/video.html#mediasource-api" class="sidebar-link">MediaSource API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javascript/video.html#使用方法" class="sidebar-link">使用方法</a></li><li class="sidebar-sub-header"><a href="/javascript/video.html#实例" class="sidebar-link">实例</a></li></ul></li><li class="sidebar-sub-header"><a href="/javascript/video.html#直播流" class="sidebar-link">直播流</a></li></ul></li></ul></div></li><li data-v-6135aa50><div class="sidebar-group collapsable" data-v-6135aa50><p class="sidebar-heading"><span>文件与二进制处理</span> <span class="arrow right"></span></p> <!----></div></li><li data-v-6135aa50><div class="sidebar-group collapsable" data-v-6135aa50><p class="sidebar-heading"><span>离线-缓存-存储</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="h5视频处理"><a href="#h5视频处理" class="header-anchor">#</a> H5视频处理</h1> <p><a href="https://github.com/webxiaoma/JavaScript-demos/tree/master/HTML5/video" target="_blank" rel="noopener noreferrer">GitHub 练习仓库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <hr> <h2 id="video-标签"><a href="#video-标签" class="header-anchor">#</a> Video 标签</h2> <h3 id="使用该标签"><a href="#使用该标签" class="header-anchor">#</a> 使用该标签</h3> <p>使用<code>Video</code>标签很简单</p> <div class="language-html extra-class"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>video<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://webxiaoma.gitee.io/sources/bhsj.mp4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">controls</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>controls<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://webxiaoma.gitee.io/sources/bhsj.mp4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>video/mp4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://webxiaoma.gitee.io/sources/bhsj.webm<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>video/webm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    抱歉您的浏览器不支持H5视7频
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>当浏览器不支持<code>Video</code>时，页面会像是<code>Video</code>内的文字。目前video支持的音频格式<code>MP4</code> 、<code>WebM</code>以及<code>Ogg</code>。这三种格式浏览器的兼容性可以<a href="http://www.w3school.com.cn/html5/html_5_audio.asp" target="_blank" rel="noopener noreferrer">查看这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，对于video标签的兼容性可以<a href="https://caniuse.com/#search=video" target="_blank" rel="noopener noreferrer">查看这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="video标签内属性"><a href="#video标签内属性" class="header-anchor">#</a> video标签内属性</h3> <ul><li><code>autoplay</code>音频在就绪后马上播放。</li> <li><code>controls</code>如向用户显示控件，比如播放按钮。</li> <li><code>loop</code>每当音频结束时重新开始播放。</li> <li><code>preload</code>	音频在页面加载时进行加载，并预备播放。如果使用 &quot;autoplay&quot;，则忽略该属性。</li> <li><code>src</code>	要播放的音频的 URL。</li> <li><code>poster</code> 规定视频正在下载时显示的图像，直到用户点击播放按钮。</li> <li><code>muted</code>  如果出现该属性，视频的音频输出为静音。</li></ul> <h3 id="video对象属性-部分"><a href="#video对象属性-部分" class="header-anchor">#</a> video对象属性(部分)</h3> <p>除了上边标签中内嵌的属性，还有以下属性<a href="http://www.runoob.com/tags/ref-av-dom.html" target="_blank" rel="noopener noreferrer">更多对像属性查看这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：</p> <ul><li><code>volume</code> 设置或返回音频的音量。</li> <li><code>paused</code> 设置或返回音频是否暂停。</li> <li><code>currentTime</code> 设置或返回音频中的当前播放位置（以秒计）。</li> <li><code>currentSrc</code> 返回当前音频的 URL。</li> <li><code>defaultMuted</code> 设置或返回音频默认是否静音。</li> <li><code>defaultPlaybackRate</code> 设置或返回音频的默认播放速度。</li> <li><code>duration</code> 返回音频的长度（以秒计）。</li> <li><code>muted</code> 	设置或返回是否关闭声音。</li> <li><code>playbackRate</code> 设置或返回音频播放的速度。</li> <li><code>ended</code> 返回音频的播放是否已结束。</li></ul> <h3 id="video-对像方法"><a href="#video-对像方法" class="header-anchor">#</a> video 对像方法</h3> <ul><li><code>addTextTrack()</code>	向音频添加新的文本轨道。</li> <li><code>canPlayType()</code>	检查浏览器是否能够播放指定的音频类型。</li> <li><code>load()</code>	重新加载音频元素。</li> <li><code>play()</code>	开始播放音频。</li> <li><code>pause()</code>	暂停当前播放的音频。</li></ul> <h3 id="多媒体事件"><a href="#多媒体事件" class="header-anchor">#</a> 多媒体事件</h3> <p>多媒体事件不多说：<a href="http://www.runoob.com/tags/ref-av-dom.html" target="_blank" rel="noopener noreferrer">可以看这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="实例练习"><a href="#实例练习" class="header-anchor">#</a> 实例练习</h3> <p>下面我们来看看使用<code>Video</code>的一些小练习<a href="https://github.com/webxiaoma/JavaScript-demos/tree/master/HTML5/video/video.html" target="_blank" rel="noopener noreferrer">GitHub仓库练习<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <iframe width="700" height="700" allowfullscreen="allowfullscreen" src="https://webxiaoma.github.io/JavaScript-demos/HTML5/video/video.html" style="border:0;"></iframe> <h2 id="mediasource-api"><a href="#mediasource-api" class="header-anchor">#</a> MediaSource API</h2> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaSource" target="_blank" rel="noopener noreferrer">MediaSource API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 扩展了视频的处理，使js生成流媒体成为了可能。下面我们来简单的使用一下<code>MediaSource API</code></p> <h3 id="使用方法"><a href="#使用方法" class="header-anchor">#</a> 使用方法</h3> <p>使用<code>MediaSource API</code>来实现媒体播放器的大致步骤如下：</p> <ol><li>在页面的<code>HTML</code>部分中定义<code>HTML5</code> 视频元素。</li> <li>在<code>JavaScript</code>中创建<code>MediaSource</code>对象。</li> <li>使用<code>createObjectURL</code>创建虚拟<code>URL</code> ，并将<code>MediaSource</code>对象作为源。</li> <li>将虚拟<code>URL</code>分配给<code>video</code>元素的<code>src</code>属性。</li> <li>使用<code>addSourceBuffer</code>创建一个<code>SourceBuffer</code>，使用您要添加的视频的<code>mime</code>类型。</li> <li>从媒体获取文件中的视频初始化段网上，并将其添加到<code>SourceBuffer</code>与<code>appendBuffer</code>。</li> <li>获取视频数据的段从媒体文件，将它们添加到<code>SourceBuffer</code>与<code>appendBuffer</code>。</li> <li>在视频元素上调用<code>play</code>方法。</li></ol> <p>实现的代码如下：</p> <div class="language-HTML extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>video<span class="token punctuation">&quot;</span></span> <span class="token attr-name">controls</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>controls<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    抱歉您的浏览器不支持H5视频
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> video <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#video'</span><span class="token punctuation">)</span>

    <span class="token comment">//创建 media source (使用`createObjectURL`创建虚拟`URL` ，并将`MediaSource`对象作为源。)</span>
    <span class="token keyword">let</span> mediaSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MediaSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    video<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>mediaSource<span class="token punctuation">)</span>
    <span class="token comment">// 设置 媒体的编码类型</span>
    <span class="token keyword">let</span> mimeCodec <span class="token operator">=</span> <span class="token string">'video/webm; codecs=&quot;vorbis, vp8&quot;'</span><span class="token punctuation">;</span>
    <span class="token comment">// let isItSupported = MediaSource.isTypeSupported(mimeCodec);</span>
     <span class="token comment">// 返回值为 Boolean, isItSupported 可以判断浏览器是否支持某个视频类型</span>
    

    <span class="token comment">//绑定到媒体元素后开始触发</span>
    mediaSource<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'sourceopen'</span><span class="token punctuation">,</span> sourceOpen<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">sourceOpen</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">//清除`createObjectURL`创建的对象并释放系统资源</span>
        <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>video<span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//创建`SourceBuffer`给定MIME类型的新内容并将其添加到  MediaSource.sourceBuffers列表中</span>
        <span class="token keyword">var</span> sourceBuffer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addSourceBuffer</span><span class="token punctuation">(</span>mimeCodec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 请求视频资源</span>
        <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;./bhsj.webm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> file<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">aryBuf</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            sourceBuffer<span class="token punctuation">.</span><span class="token function">appendBuffer</span><span class="token punctuation">(</span>aryBuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        sourceBuffer<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'updateend'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>sourceBuffer<span class="token punctuation">.</span>updating <span class="token operator">&amp;&amp;</span> mediaSource<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token string">'open'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                mediaSource<span class="token punctuation">.</span><span class="token function">endOfStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                video<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><p>通过代码我们可以看出，使用使用<code>createObjectURL</code>创建虚拟<code>URL</code>，将其赋值给<code>video.src</code>后这时<code>video</code>和<code>mediaSource</code>就已经连接起来了, 此时<code>createObjectURL</code>创建的对象也就没有用了，我们可以使用<code>URL.revokeObjectURL()</code> 来清除<code>createObjectURL</code>创建的对象并释放系统资源。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> video <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#video'</span><span class="token punctuation">)</span>
<span class="token comment">//创建 media source (使用`createObjectURL`创建虚拟`URL` ，并将`MediaSource`对象作为源。)</span>
<span class="token keyword">let</span> mediaSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MediaSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
video<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>mediaSource<span class="token punctuation">)</span>

</code></pre></div><p>现在虽然<code>vidoe</code>元素与<code>Media Source</code>媒体对象已经连接了，但是还没有媒体资源，所以这里还是不能播放，我们需要将视频资源添加到媒体<code>mediaSource</code>实例中。这里就要提到<code>Media Source Extensions</code>支持的几种事件</p> <ul><li><code>onsourceopen</code> 绑定到媒体元素后开始触发</li> <li><code>onsourceclosed</code> 未绑定到媒体元素后开始触发</li> <li><code>onsourceended</code> 所有数据接收完成后触发</li></ul> <p>同时<code>Media Source Extensions</code>实例上还有几个属性</p> <ul><li><code>sourceBuffers</code> 返回一个<code>SourceBufferList</code>对象，其中包含<code>SourceBuffer</code>与此关联的对象列表MediaSource。</li> <li><code>activeSourceBuffers</code> 返回<code>SourceBufferList</code>包含其中包含的对象子集的  <code>SourceBuffer</code>对象<code>MediaSource.sourceBuffers</code> 提供所选视频轨道的对象列表，启用的音频轨道以及显示/隐藏的文本轨道。</li> <li><code>readyState</code> 返回表示当前状态的枚举<code>MediaSource</code>，无论它当前是否附加到媒体元素（<code>closed</code>），附加并准备接收SourceBuffer对象（<code>open</code>）或附加但是流已通过<code>MediaSource.endOfStream()</code>（<code>ended</code>。）结束</li> <li><code>duration</code> 获取并设置当前媒体的持续时间。</li></ul> <p>这里需要知道的是在<code>readyState</code> 属性有三个值，如下：</p> <ul><li><code>open</code> 已经绑定到了媒体元素上，等待接受数据或者正在接受数据</li> <li><code>closed</code>未绑定到了媒体元素上</li> <li><code>ended</code>已经绑定到了媒体元素上, 并且所有数据都已经接受到了</li></ul> <p>另外<code>Media Source Extensions</code>实例上还有几个方法</p> <ul><li><code>addSourceBuffer()</code> 创建<code>SourceBuffer</code>给定MIME类型的新内容并将其添加到<code>MediaSource.sourceBuffers</code>列表中。</li> <li><code>endOfStream()</code> 表示流的结尾。</li> <li><code>removeSourceBuffer()</code> 删除<code>MediaSource.sourceBuffers</code>列表中给定的<code>SourceBuffer</code>。</li></ul> <p>在我们请求媒体资源并添加到<code>MediaSource</code> 实例时我们需要先设定音频和视频的编码格式：</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 设置编码格式</span>
  <span class="token keyword">let</span> mimeCodec <span class="token operator">=</span> <span class="token string">'video/webm; codecs=&quot;vorbis, vp8&quot;'</span><span class="token punctuation">;</span>
    <span class="token comment">//绑定到媒体元素后开始触发</span>
    mediaSource<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'sourceopen'</span><span class="token punctuation">,</span> sourceOpen<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">sourceOpen</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//创建`SourceBuffer`给定MIME类型的新内容并将其添加到  MediaSource.sourceBuffers列表中</span>
        <span class="token keyword">var</span> sourceBuffer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addSourceBuffer</span><span class="token punctuation">(</span>mimeCodec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>关于MIM视频编码格式：</p> <ol><li>webm格式的视频编码格式一般设置为<code>video/webm; codecs=&quot;vorbis, vp8&quot;</code></li> <li>mp4格式的视频编码格式有很多，列如<code>video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;</code>，（mp4格式的视频我在进行编码时我这边没有成功）</li></ol> <p>编码格式设置好后我们需要请求视频资源了, 我们请求下来的视频流喂给<code>vidoe</code>，喂给<code>video</code>后会触发<code>sourceBuffer</code>的<code>updateend</code>事件，在该事件中我们需要调用<code>mediaSource</code>的<code>endOfStream()</code>方法，来改变<code>MediaSource.readyState</code> 为 <code>ended</code> 并且触发 <code>sourceended</code> 事件。</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">//绑定到媒体元素后开始触发</span>
mediaSource<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'sourceopen'</span><span class="token punctuation">,</span> sourceOpen<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">sourceOpen</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//清除`createObjectURL`创建的对象并释放系统资源</span>
    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>video<span class="token punctuation">.</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//创建`SourceBuffer`给定MIME类型的新内容并将其添加到  MediaSource.sourceBuffers列表中</span>
    <span class="token keyword">var</span> sourceBuffer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addSourceBuffer</span><span class="token punctuation">(</span>mimeCodec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 请求视频资源</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;./bhsj.webm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> file<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">aryBuf</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//通过appendBuffe 方法将视频流喂给video</span>
        sourceBuffer<span class="token punctuation">.</span><span class="token function">appendBuffer</span><span class="token punctuation">(</span>aryBuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    sourceBuffer<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'updateend'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>sourceBuffer<span class="token punctuation">.</span>updating <span class="token operator">&amp;&amp;</span> mediaSource<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token string">'open'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            mediaSource<span class="token punctuation">.</span><span class="token function">endOfStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            video<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>我们可以使用<code>appendBuffer</code>方法向``sourceBuffer<code>中添加多个视频了流，来持续进行视频播放（或直播流），在添加多个视频流时我们需要监听</code>SourceBuffer<code>上的</code>updateend` 事件，确定空闲后，再加入新的视频流</p> <div class="language-js extra-class"><pre class="language-js"><code>sourceBuffer<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'updateend'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 先设定新流加入的位置，比如第120秒处</span>
    sourceBuffer<span class="token punctuation">.</span>timestampOffset <span class="token operator">=</span> <span class="token number">120</span>
    <span class="token comment">// 然后加入新视频流</span>
    sourceBuffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>newBuffer<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h3 id="实例"><a href="#实例" class="header-anchor">#</a> 实例</h3> <p>下面我们来看看使用<code>Media Source Extensions</code>的一些小练习<a href="https://github.com/webxiaoma/JavaScript-demos/tree/master/HTML5/video/video-api.html" target="_blank" rel="noopener noreferrer">GitHub仓库练习<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, 需要注意的是该例子需要请求视频资源（格式为webpm），请求时间可能受网络影响，同时，该视频使用<code>fetch</code> 方法做的请求，请检查你的浏览器是否支持<code>fetch api</code>。</p> <iframe width="700" height="300" allowfullscreen="allowfullscreen" src="https://webxiaoma.github.io/JavaScript-demos/HTML5/video/video-api.html" style="border:0;"></iframe> <h2 id="直播流"><a href="#直播流" class="header-anchor">#</a> 直播流</h2> <ol><li><strong>RTMP协议直播源</strong></li></ol> <ul><li>香港卫视：rtmp://live.hkstv.hk.lxdns.com/live/hks</li></ul> <ol start="2"><li><strong>RTSP协议直播源</strong></li></ol> <ul><li>珠海过澳门大厅摄像头监控：rtsp://218.204.223.237:554/live/1/66251FC11353191F/e7ooqwcfbqjoo80j.sdp</li> <li>大熊兔（点播）：rtsp://184.72.239.149/vod/mp4://BigBuckBunny_175k.mov</li></ul> <ol start="3"><li><strong>HTTP协议直播源</strong></li></ol> <ul><li>香港卫视：http://live.hkstv.hk.lxdns.com/live/hks/playlist.m3u8</li> <li>CCTV1高清：http://ivi.bupt.edu.cn/hls/cctv1hd.m3u8</li> <li>CCTV3高清：http://ivi.bupt.edu.cn/hls/cctv3hd.m3u8</li> <li>CCTV5高清：http://ivi.bupt.edu.cn/hls/cctv5hd.m3u8</li> <li>CCTV5+高清：http://ivi.bupt.edu.cn/hls/cctv5phd.m3u8</li> <li>CCTV6高清：http://ivi.bupt.edu.cn/hls/cctv6hd.m3u8</li> <li>苹果提供的测试源（点播）：http://devimages.apple.com.edgekey.net/streaming/examples/bipbop_4x3/gear2/prog_index.m3u8</li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/webxiaoma/webxiaoma/edit/dev/docs/javascript/video.md" target="_blank" rel="noopener noreferrer">文章有问题，欢迎提出！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最近更新时间: </span> <span class="time">3/31/2020, 6:01:36 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/javascript/audio.html" class="prev">
          H5音频处理
        </a></span> <span class="next"><a href="/javascript/ArrayBuffer.html">
          ArrayBuffer处理二进制
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.b5bf64aa.js" defer></script><script src="/assets/js/56.d2246bfc.js" defer></script>
  </body>
</html>
