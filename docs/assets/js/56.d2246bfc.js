(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{402:function(t,s,a){"use strict";a.r(s);var e=a(1),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/webxiaoma/JavaScript-demos/tree/master/HTML5/video",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub 练习仓库"),a("OutboundLink")],1)]),t._v(" "),a("hr"),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),a("p",[t._v("当浏览器不支持"),a("code",[t._v("Video")]),t._v("时，页面会像是"),a("code",[t._v("Video")]),t._v("内的文字。目前video支持的音频格式"),a("code",[t._v("MP4")]),t._v(" 、"),a("code",[t._v("WebM")]),t._v("以及"),a("code",[t._v("Ogg")]),t._v("。这三种格式浏览器的兼容性可以"),a("a",{attrs:{href:"http://www.w3school.com.cn/html5/html_5_audio.asp",target:"_blank",rel:"noopener noreferrer"}},[t._v("查看这里"),a("OutboundLink")],1),t._v("，对于video标签的兼容性可以"),a("a",{attrs:{href:"https://caniuse.com/#search=video",target:"_blank",rel:"noopener noreferrer"}},[t._v("查看这里"),a("OutboundLink")],1)]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),a("p",[t._v("除了上边标签中内嵌的属性，还有以下属性"),a("a",{attrs:{href:"http://www.runoob.com/tags/ref-av-dom.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("更多对像属性查看这里"),a("OutboundLink")],1),t._v("：")]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),a("p",[t._v("多媒体事件不多说："),a("a",{attrs:{href:"http://www.runoob.com/tags/ref-av-dom.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("可以看这里"),a("OutboundLink")],1)]),t._v(" "),t._m(12),t._v(" "),a("p",[t._v("下面我们来看看使用"),a("code",[t._v("Video")]),t._v("的一些小练习"),a("a",{attrs:{href:"https://github.com/webxiaoma/JavaScript-demos/tree/master/HTML5/video/video.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub仓库练习"),a("OutboundLink")],1)]),t._v(" "),a("iframe",{staticStyle:{border:"0"},attrs:{width:"700",height:"700",allowfullscreen:"",src:"https://webxiaoma.github.io/JavaScript-demos/HTML5/video/video.html"}}),t._v(" "),t._m(13),t._v(" "),a("p",[a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/MediaSource",target:"_blank",rel:"noopener noreferrer"}},[t._v("MediaSource API"),a("OutboundLink")],1),t._v(" 扩展了视频的处理，使js生成流媒体成为了可能。下面我们来简单的使用一下"),a("code",[t._v("MediaSource API")])]),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),a("p",[t._v("实现的代码如下：")]),t._v(" "),t._m(17),t._m(18),t._v(" "),t._m(19),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),a("p",[t._v("关于MIM视频编码格式：")]),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._m(33),t._v(" "),t._m(34),t._v(" "),a("p",[t._v("下面我们来看看使用"),a("code",[t._v("Media Source Extensions")]),t._v("的一些小练习"),a("a",{attrs:{href:"https://github.com/webxiaoma/JavaScript-demos/tree/master/HTML5/video/video-api.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub仓库练习"),a("OutboundLink")],1),t._v(", 需要注意的是该例子需要请求视频资源（格式为webpm），请求时间可能受网络影响，同时，该视频使用"),a("code",[t._v("fetch")]),t._v(" 方法做的请求，请检查你的浏览器是否支持"),a("code",[t._v("fetch api")]),t._v("。")]),t._v(" "),a("iframe",{staticStyle:{border:"0"},attrs:{width:"700",height:"300",allowfullscreen:"",src:"https://webxiaoma.github.io/JavaScript-demos/HTML5/video/video-api.html"}}),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),t._m(40),t._v(" "),t._m(41)])}),[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"h5视频处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#h5视频处理"}},[this._v("#")]),this._v(" H5视频处理")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"video-标签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#video-标签"}},[this._v("#")]),this._v(" Video 标签")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"使用该标签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用该标签"}},[this._v("#")]),this._v(" 使用该标签")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用"),s("code",[this._v("Video")]),this._v("标签很简单")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("video")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("video"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://webxiaoma.gitee.io/sources/bhsj.mp4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("controls")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("controls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("source")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://webxiaoma.gitee.io/sources/bhsj.mp4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("video/mp4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("source")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://webxiaoma.gitee.io/sources/bhsj.webm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("video/webm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    抱歉您的浏览器不支持H5视7频\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("video")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"video标签内属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#video标签内属性"}},[this._v("#")]),this._v(" video标签内属性")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("autoplay")]),t._v("音频在就绪后马上播放。")]),t._v(" "),a("li",[a("code",[t._v("controls")]),t._v("如向用户显示控件，比如播放按钮。")]),t._v(" "),a("li",[a("code",[t._v("loop")]),t._v("每当音频结束时重新开始播放。")]),t._v(" "),a("li",[a("code",[t._v("preload")]),t._v('\t音频在页面加载时进行加载，并预备播放。如果使用 "autoplay"，则忽略该属性。')]),t._v(" "),a("li",[a("code",[t._v("src")]),t._v("\t要播放的音频的 URL。")]),t._v(" "),a("li",[a("code",[t._v("poster")]),t._v(" 规定视频正在下载时显示的图像，直到用户点击播放按钮。")]),t._v(" "),a("li",[a("code",[t._v("muted")]),t._v("  如果出现该属性，视频的音频输出为静音。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"video对象属性-部分"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#video对象属性-部分"}},[this._v("#")]),this._v(" video对象属性(部分)")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("volume")]),t._v(" 设置或返回音频的音量。")]),t._v(" "),a("li",[a("code",[t._v("paused")]),t._v(" 设置或返回音频是否暂停。")]),t._v(" "),a("li",[a("code",[t._v("currentTime")]),t._v(" 设置或返回音频中的当前播放位置（以秒计）。")]),t._v(" "),a("li",[a("code",[t._v("currentSrc")]),t._v(" 返回当前音频的 URL。")]),t._v(" "),a("li",[a("code",[t._v("defaultMuted")]),t._v(" 设置或返回音频默认是否静音。")]),t._v(" "),a("li",[a("code",[t._v("defaultPlaybackRate")]),t._v(" 设置或返回音频的默认播放速度。")]),t._v(" "),a("li",[a("code",[t._v("duration")]),t._v(" 返回音频的长度（以秒计）。")]),t._v(" "),a("li",[a("code",[t._v("muted")]),t._v(" \t设置或返回是否关闭声音。")]),t._v(" "),a("li",[a("code",[t._v("playbackRate")]),t._v(" 设置或返回音频播放的速度。")]),t._v(" "),a("li",[a("code",[t._v("ended")]),t._v(" 返回音频的播放是否已结束。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"video-对像方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#video-对像方法"}},[this._v("#")]),this._v(" video 对像方法")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("addTextTrack()")]),t._v("\t向音频添加新的文本轨道。")]),t._v(" "),a("li",[a("code",[t._v("canPlayType()")]),t._v("\t检查浏览器是否能够播放指定的音频类型。")]),t._v(" "),a("li",[a("code",[t._v("load()")]),t._v("\t重新加载音频元素。")]),t._v(" "),a("li",[a("code",[t._v("play()")]),t._v("\t开始播放音频。")]),t._v(" "),a("li",[a("code",[t._v("pause()")]),t._v("\t暂停当前播放的音频。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"多媒体事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多媒体事件"}},[this._v("#")]),this._v(" 多媒体事件")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"实例练习"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实例练习"}},[this._v("#")]),this._v(" 实例练习")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"mediasource-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mediasource-api"}},[this._v("#")]),this._v(" MediaSource API")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"使用方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用方法"}},[this._v("#")]),this._v(" 使用方法")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用"),s("code",[this._v("MediaSource API")]),this._v("来实现媒体播放器的大致步骤如下：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ol",[a("li",[t._v("在页面的"),a("code",[t._v("HTML")]),t._v("部分中定义"),a("code",[t._v("HTML5")]),t._v(" 视频元素。")]),t._v(" "),a("li",[t._v("在"),a("code",[t._v("JavaScript")]),t._v("中创建"),a("code",[t._v("MediaSource")]),t._v("对象。")]),t._v(" "),a("li",[t._v("使用"),a("code",[t._v("createObjectURL")]),t._v("创建虚拟"),a("code",[t._v("URL")]),t._v(" ，并将"),a("code",[t._v("MediaSource")]),t._v("对象作为源。")]),t._v(" "),a("li",[t._v("将虚拟"),a("code",[t._v("URL")]),t._v("分配给"),a("code",[t._v("video")]),t._v("元素的"),a("code",[t._v("src")]),t._v("属性。")]),t._v(" "),a("li",[t._v("使用"),a("code",[t._v("addSourceBuffer")]),t._v("创建一个"),a("code",[t._v("SourceBuffer")]),t._v("，使用您要添加的视频的"),a("code",[t._v("mime")]),t._v("类型。")]),t._v(" "),a("li",[t._v("从媒体获取文件中的视频初始化段网上，并将其添加到"),a("code",[t._v("SourceBuffer")]),t._v("与"),a("code",[t._v("appendBuffer")]),t._v("。")]),t._v(" "),a("li",[t._v("获取视频数据的段从媒体文件，将它们添加到"),a("code",[t._v("SourceBuffer")]),t._v("与"),a("code",[t._v("appendBuffer")]),t._v("。")]),t._v(" "),a("li",[t._v("在视频元素上调用"),a("code",[t._v("play")]),t._v("方法。")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-HTML extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("video")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("video"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("controls")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("controls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    抱歉您的浏览器不支持H5视频\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("video")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" video "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#video'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建 media source (使用`createObjectURL`创建虚拟`URL` ，并将`MediaSource`对象作为源。)")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" mediaSource "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MediaSource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    video"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createObjectURL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mediaSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置 媒体的编码类型")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" mimeCodec "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'video/webm; codecs=\"vorbis, vp8\"'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// let isItSupported = MediaSource.isTypeSupported(mimeCodec);")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回值为 Boolean, isItSupported 可以判断浏览器是否支持某个视频类型")]),t._v("\n    \n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//绑定到媒体元素后开始触发")]),t._v("\n    mediaSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sourceopen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sourceOpen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sourceOpen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//清除`createObjectURL`创建的对象并释放系统资源")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("revokeObjectURL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("video"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建`SourceBuffer`给定MIME类型的新内容并将其添加到  MediaSource.sourceBuffers列表中")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" sourceBuffer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addSourceBuffer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mimeCodec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求视频资源")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./bhsj.webm"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("arrayBuffer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("aryBuf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            sourceBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendBuffer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("aryBuf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        sourceBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'updateend'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("sourceBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("updating "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" mediaSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'open'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                mediaSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("endOfStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                video"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("play")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("通过代码我们可以看出，使用使用"),a("code",[t._v("createObjectURL")]),t._v("创建虚拟"),a("code",[t._v("URL")]),t._v("，将其赋值给"),a("code",[t._v("video.src")]),t._v("后这时"),a("code",[t._v("video")]),t._v("和"),a("code",[t._v("mediaSource")]),t._v("就已经连接起来了, 此时"),a("code",[t._v("createObjectURL")]),t._v("创建的对象也就没有用了，我们可以使用"),a("code",[t._v("URL.revokeObjectURL()")]),t._v(" 来清除"),a("code",[t._v("createObjectURL")]),t._v("创建的对象并释放系统资源。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" video "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#video'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建 media source (使用`createObjectURL`创建虚拟`URL` ，并将`MediaSource`对象作为源。)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" mediaSource "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MediaSource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nvideo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createObjectURL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mediaSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("现在虽然"),a("code",[t._v("vidoe")]),t._v("元素与"),a("code",[t._v("Media Source")]),t._v("媒体对象已经连接了，但是还没有媒体资源，所以这里还是不能播放，我们需要将视频资源添加到媒体"),a("code",[t._v("mediaSource")]),t._v("实例中。这里就要提到"),a("code",[t._v("Media Source Extensions")]),t._v("支持的几种事件")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("onsourceopen")]),t._v(" 绑定到媒体元素后开始触发")]),t._v(" "),a("li",[a("code",[t._v("onsourceclosed")]),t._v(" 未绑定到媒体元素后开始触发")]),t._v(" "),a("li",[a("code",[t._v("onsourceended")]),t._v(" 所有数据接收完成后触发")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("同时"),s("code",[this._v("Media Source Extensions")]),this._v("实例上还有几个属性")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("sourceBuffers")]),t._v(" 返回一个"),a("code",[t._v("SourceBufferList")]),t._v("对象，其中包含"),a("code",[t._v("SourceBuffer")]),t._v("与此关联的对象列表MediaSource。")]),t._v(" "),a("li",[a("code",[t._v("activeSourceBuffers")]),t._v(" 返回"),a("code",[t._v("SourceBufferList")]),t._v("包含其中包含的对象子集的  "),a("code",[t._v("SourceBuffer")]),t._v("对象"),a("code",[t._v("MediaSource.sourceBuffers")]),t._v(" 提供所选视频轨道的对象列表，启用的音频轨道以及显示/隐藏的文本轨道。")]),t._v(" "),a("li",[a("code",[t._v("readyState")]),t._v(" 返回表示当前状态的枚举"),a("code",[t._v("MediaSource")]),t._v("，无论它当前是否附加到媒体元素（"),a("code",[t._v("closed")]),t._v("），附加并准备接收SourceBuffer对象（"),a("code",[t._v("open")]),t._v("）或附加但是流已通过"),a("code",[t._v("MediaSource.endOfStream()")]),t._v("（"),a("code",[t._v("ended")]),t._v("。）结束")]),t._v(" "),a("li",[a("code",[t._v("duration")]),t._v(" 获取并设置当前媒体的持续时间。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这里需要知道的是在"),s("code",[this._v("readyState")]),this._v(" 属性有三个值，如下：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("open")]),t._v(" 已经绑定到了媒体元素上，等待接受数据或者正在接受数据")]),t._v(" "),a("li",[a("code",[t._v("closed")]),t._v("未绑定到了媒体元素上")]),t._v(" "),a("li",[a("code",[t._v("ended")]),t._v("已经绑定到了媒体元素上, 并且所有数据都已经接受到了")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("另外"),s("code",[this._v("Media Source Extensions")]),this._v("实例上还有几个方法")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("code",[t._v("addSourceBuffer()")]),t._v(" 创建"),a("code",[t._v("SourceBuffer")]),t._v("给定MIME类型的新内容并将其添加到"),a("code",[t._v("MediaSource.sourceBuffers")]),t._v("列表中。")]),t._v(" "),a("li",[a("code",[t._v("endOfStream()")]),t._v(" 表示流的结尾。")]),t._v(" "),a("li",[a("code",[t._v("removeSourceBuffer()")]),t._v(" 删除"),a("code",[t._v("MediaSource.sourceBuffers")]),t._v("列表中给定的"),a("code",[t._v("SourceBuffer")]),t._v("。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在我们请求媒体资源并添加到"),s("code",[this._v("MediaSource")]),this._v(" 实例时我们需要先设定音频和视频的编码格式：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置编码格式")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" mimeCodec "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'video/webm; codecs=\"vorbis, vp8\"'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//绑定到媒体元素后开始触发")]),t._v("\n    mediaSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sourceopen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sourceOpen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sourceOpen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建`SourceBuffer`给定MIME类型的新内容并将其添加到  MediaSource.sourceBuffers列表中")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" sourceBuffer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addSourceBuffer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mimeCodec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("webm格式的视频编码格式一般设置为"),s("code",[this._v('video/webm; codecs="vorbis, vp8"')])]),this._v(" "),s("li",[this._v("mp4格式的视频编码格式有很多，列如"),s("code",[this._v('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')]),this._v("，（mp4格式的视频我在进行编码时我这边没有成功）")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("编码格式设置好后我们需要请求视频资源了, 我们请求下来的视频流喂给"),a("code",[t._v("vidoe")]),t._v("，喂给"),a("code",[t._v("video")]),t._v("后会触发"),a("code",[t._v("sourceBuffer")]),t._v("的"),a("code",[t._v("updateend")]),t._v("事件，在该事件中我们需要调用"),a("code",[t._v("mediaSource")]),t._v("的"),a("code",[t._v("endOfStream()")]),t._v("方法，来改变"),a("code",[t._v("MediaSource.readyState")]),t._v(" 为 "),a("code",[t._v("ended")]),t._v(" 并且触发 "),a("code",[t._v("sourceended")]),t._v(" 事件。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//绑定到媒体元素后开始触发")]),t._v("\nmediaSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sourceopen'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sourceOpen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sourceOpen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//清除`createObjectURL`创建的对象并释放系统资源")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("revokeObjectURL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("video"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建`SourceBuffer`给定MIME类型的新内容并将其添加到  MediaSource.sourceBuffers列表中")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" sourceBuffer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addSourceBuffer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mimeCodec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求视频资源")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./bhsj.webm"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("arrayBuffer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("aryBuf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//通过appendBuffe 方法将视频流喂给video")]),t._v("\n        sourceBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendBuffer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("aryBuf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    sourceBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'updateend'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("sourceBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("updating "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" mediaSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'open'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            mediaSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("endOfStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            video"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("play")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("我们可以使用"),a("code",[t._v("appendBuffer")]),t._v("方法向``sourceBuffer"),a("code",[t._v("中添加多个视频了流，来持续进行视频播放（或直播流），在添加多个视频流时我们需要监听")]),t._v("SourceBuffer"),a("code",[t._v("上的")]),t._v("updateend` 事件，确定空闲后，再加入新的视频流")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("sourceBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'updateend'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 先设定新流加入的位置，比如第120秒处")]),t._v("\n    sourceBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timestampOffset "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("120")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 然后加入新视频流")]),t._v("\n    sourceBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[this._v("#")]),this._v(" 实例")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"直播流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#直播流"}},[this._v("#")]),this._v(" 直播流")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[s("strong",[this._v("RTMP协议直播源")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("香港卫视：rtmp://live.hkstv.hk.lxdns.com/live/hks")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"2"}},[s("li",[s("strong",[this._v("RTSP协议直播源")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("珠海过澳门大厅摄像头监控：rtsp://218.204.223.237:554/live/1/66251FC11353191F/e7ooqwcfbqjoo80j.sdp")]),this._v(" "),s("li",[this._v("大熊兔（点播）：rtsp://184.72.239.149/vod/mp4://BigBuckBunny_175k.mov")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"3"}},[s("li",[s("strong",[this._v("HTTP协议直播源")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("香港卫视：http://live.hkstv.hk.lxdns.com/live/hks/playlist.m3u8")]),t._v(" "),a("li",[t._v("CCTV1高清：http://ivi.bupt.edu.cn/hls/cctv1hd.m3u8")]),t._v(" "),a("li",[t._v("CCTV3高清：http://ivi.bupt.edu.cn/hls/cctv3hd.m3u8")]),t._v(" "),a("li",[t._v("CCTV5高清：http://ivi.bupt.edu.cn/hls/cctv5hd.m3u8")]),t._v(" "),a("li",[t._v("CCTV5+高清：http://ivi.bupt.edu.cn/hls/cctv5phd.m3u8")]),t._v(" "),a("li",[t._v("CCTV6高清：http://ivi.bupt.edu.cn/hls/cctv6hd.m3u8")]),t._v(" "),a("li",[t._v("苹果提供的测试源（点播）：http://devimages.apple.com.edgekey.net/streaming/examples/bipbop_4x3/gear2/prog_index.m3u8")])])}],!1,null,null,null);s.default=n.exports}}]);