---
sidebarDepth: 2
meta:
  - name: keywordsv
    content: touch事件，touchend，移动端事件，事件，手机端，重力感应，横屏检测
  - name: description
    content: 本文章为主要讲解移动端常见的事件，如touch事件，重力事件，横竖屏检测，手机旋转检测等。
---

# 移动端的事件处理

---


##  移动端基础事件

### **1.基础事件**

::: tip

- **touchstart** 手指按下时触发   
- **touchmove** 手指移动时触发
- **touchend** 手指抬起时触发
:::


### **2.使用方法**

我们在使用上面三个事件时，要用js 的事件绑定方式去使用`addEventListener()`, JQ 的  `on()` 等绑定事件不起作用，例如：

```js
var body = document.querySelector("body");
body.addEventListener("touchstart",start);

function start(e) {
  console.log("按下手指");
  console.log(e)
}
```

### **3.移动端事件对象**

移动端中通过事件对象我们能获取很多信息。比如，手指点击的坐标，手指一动的距离，点击屏幕的手指个数等等。

-  **`tocuhes`** 当前手指触屏的个数
  
-  **`targetTouches`** 位于当前DOM 元素上的手指的一个列表
  
-  **`changeTocuhes`**  涉及当前事件的手指的一个列表
  
-  **`clientX`**  触摸目标在视口中的x坐标

-  **`pageX`**  触摸目标在页面中的x坐标

-  **`screenX`**  触摸目标在屏幕中的x坐标


获取触控点数：

```html
<div class="warp"></div>
 
<script>
var div = document.querySelector(".warp");

div.addEventListener("touchstart",function(e){
   console.log(e)
   div.innerHTML =e.targetTouches.length;
});
</script>
```

还可以获取触摸点的坐标：

```js
div.addEventListener("touchstart",function(e){
   var tager = e.touches[0] // 获取第一个触点
   div.innerHTML = tager.pageX;
});
```

### **4.注意事项**

- 使用`touchend` 可以消除点击事件的300ms 延迟，click 事件是有300ms 延迟的。（也可以解决点透问题）

```js

div.addEventListener("click",click);
div.addEventListener("touchend",end);

function click() {
  console.log("点击事件")
}

function end() {
   console.log("抬起手指")
}
// 上面结果， end 函数会先触发，click 事件后触发， 
```

- 在ios10下面，`user-scalable=no,` 禁止用户缩放不起作用，使用阻止pc默认事件就会生效。

```js
document.addEventListener("touchstart",function(e){
   e.preventDefault();
});
```

① 阻止默认事件还会解决IOS10 下使用 `overflow:hidden` 失效问题

② 阻止默认事件还会 禁止系统默认的滚动条，阻止橡皮筋效果

③ 阻止默认事件还会 禁止长按选中文字，选中图片，系统默认菜单。




## 移动端陀螺仪

### 1.重力感应 

::: tip  devicemotion事件

事件对象（event）
- **`acceration` :** 一个包含x,y,z 的属性对象，在不考虑重力的情况下，告诉你在每个方向上的加速度。
- **`accelerationIncludingGravity` :** 一个包含x,y,z 的属性对象，在考虑z轴自然重力加速度的情况下，告诉你在每个方向上的加速度。
- **`rotationRate` :** 一个包含表示方向的 alpha、beta 和 gamma属性对象。
:::
 

```js
var div = document.querySelector('div');
    window.addEventListener('devicemotion',function(e){
        console.log(e)
        var motion = e.accelerationIncludingGravity;
        var x = motion.x;
        var y = motion.y;
        var z = motion.z; // 安卓显示正直，ios显示负值

        div.innerHTML = "x: " + x;
        div.innerHTML += "<br/>y: " + y;
        div.innerHTML += "<br/>z: " + z;
    })
```

### **2.横竖屏检测**

        
::: tip   orientationchange 事件
其中 **window.orientatio** 包含了设备横竖屏转动时的几个值：

-  0：表示肖像模式。
- 90：表示向左旋转的横向模式。
- -90：表示向右旋转的横向模式。
:::    

```js
window.addEventListener('orientationchange',function(e){
     alert(window.orientation);
 })
```

### **3.检测手机旋转**

::: tip   deviceorientation 事件
事件对象（event）

- `alpha` : 在围绕z轴旋转时，y轴的度数差，是一个介于0到360之间的浮点数
- `beta` : 在围绕x轴旋转时，z轴的度数差，是一个介于-180到180之间的浮点数
- `gamma` : 在围绕y轴旋转时，z轴的度数差，是一个介于-90到90之间的浮点数
:::    
   

```js
 var p = document.querySelector('p');
    window.addEventListener('deviceorientation',function(e){    
       body.innerHTML = "Z: " + e.alpha;  // 手机z轴旋转角度
    })
```

